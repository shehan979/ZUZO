/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /gh/nocodesupplyco/mast@master/inline-video.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
class VideoLibrary{constructor(e={}){this.options={rootMargin:e.rootMargin||"100px",threshold:e.threshold||0,scrollTriggerThreshold:e.scrollTriggerThreshold||.5,debug:e.debug||!1,...e},this.prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,this.videoObserver=null,this.scrollObservers=new Map,this.pictureElementCache=new WeakMap,this.eventListeners=new WeakMap,this.resizeHandler=null,this.resizeTimeout=null,this.init()}init(){if(0===document.querySelectorAll("video[data-video]").length)return;this.prefersReducedMotion&&console.log("User prefers reduced motion. Videos will not auto-play."),this.removeDesktopOnlyVideos(),this.setupLazyLoading(),this.setupVideoControls(),this.setupHoverPlay();document.querySelectorAll('video[data-video-desktop-only="true"]').length>0&&(this.resizeHandler=()=>{this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout((()=>{this.removeDesktopOnlyVideos()}),150)},window.addEventListener("resize",this.resizeHandler))}getComponentContainer(e){return e.closest('[data-video="component"]')||e.parentElement||null}removeDesktopOnlyVideos(){const e=document.querySelectorAll('video[data-video-desktop-only="true"]'),t=window.innerWidth<=991;e.forEach((e=>{const i=this.getComponentContainer(e),r=i?i.querySelector('[data-video-playback="wrapper"]'):null;t?(e.style.display="none",this.showPictureElement(e),r&&(r.style.display="none",r.style.visibility="hidden",r.setAttribute("aria-hidden","true"))):(e.style.display="",this.hidePictureElement(e),r&&(r.style.display="",r.style.visibility="",r.setAttribute("aria-hidden","false")))}))}setupLazyLoading(){const e=document.querySelectorAll("video[data-video]");if(0===e.length)return;const t={root:null,rootMargin:this.options.rootMargin,threshold:this.options.threshold};this.videoObserver=new IntersectionObserver(((e,t)=>{e.forEach((e=>{if(e.isIntersecting){const i=e.target;this.lazyLoadVideo(i).then((()=>t.unobserve(i))).catch(console.error)}}))}),t),e.forEach((e=>{const t="true"===e.getAttribute("data-video-scroll-in-play"),i="true"===e.getAttribute("data-video-hover");this.videoObserver.observe(e),i&&t?this.setupScrollInPlayForHover(e):i||(this.prefersReducedMotion?e.pause():t?this.setupScrollInPlay(e):this.setupAutoplay(e))}))}lazyLoadVideo(e){return new Promise(((t,i)=>{const r=e.querySelector("source[data-src]");r&&!r.src?(r.src=r.getAttribute("data-src"),e.load(),e.addEventListener("canplaythrough",(function i(){e.removeEventListener("canplaythrough",i),t()})),e.addEventListener("error",(function t(){e.removeEventListener("error",t),i(new Error(`Error loading video: ${r.src}`))}))):t()}))}showPictureElement(e){const t=this.findPictureElement(e);t&&(t.style.display="block")}hidePictureElement(e){const t=this.findPictureElement(e);t&&(t.style.display="none")}findPictureElement(e){if(this.pictureElementCache.has(e))return this.pictureElementCache.get(e);let t=null,i=e.previousElementSibling;for(;i;){if("PICTURE"===i.tagName||"IMG"===i.tagName){t=i;break}i=i.previousElementSibling}if(!t){const i=this.getComponentContainer(e);i&&(t=i.querySelector("picture, img"))}return this.pictureElementCache.set(e,t),t}setupVideoControls(){document.querySelectorAll("video[data-video]").forEach((e=>{this.handlePlaybackButtons(e)}))}setupHoverPlay(){document.querySelectorAll('video[data-video-hover="true"]').forEach((e=>{const t=this.getComponentContainer(e),i=t||e;let r=!1;if(i){if(this.showPictureElement(e),t){const e=t.querySelector('[data-video-playback="button"]');e&&(e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex","-1"))}const o=async()=>{if(!this.prefersReducedMotion)try{this.hidePictureElement(e),await this.lazyLoadVideo(e),r||(e.currentTime=0,r=!0),e.play()}catch(e){console.error("Error playing hover video:",e)}},s=()=>{e.pause()};i.addEventListener("mouseenter",o),i.addEventListener("mouseleave",s),this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push({element:i,type:"mouseenter",handler:o},{element:i,type:"mouseleave",handler:s})}}))}setupAutoplay(e){e.addEventListener("canplaythrough",(()=>{this.prefersReducedMotion||(this.hidePictureElement(e),e.play().catch(console.error))}))}setupScrollInPlay(e){let t=!1;const i=new IntersectionObserver((i=>{for(const r of i)r.isIntersecting?this.lazyLoadVideo(e).then((()=>{this.prefersReducedMotion||(this.hidePictureElement(e),t||(e.currentTime=0,t=!0),e.play())})).catch(console.error):e.pause()}),{threshold:this.options.scrollTriggerThreshold});i.observe(e),this.scrollObservers.set(e,i)}setupScrollInPlayForHover(e){const t=new IntersectionObserver((t=>{for(const i of t)i.isIntersecting&&this.lazyLoadVideo(e).then((()=>{e.pause(),this.showPictureElement(e)})).catch(console.error)}),{threshold:this.options.scrollTriggerThreshold});t.observe(e),this.scrollObservers.set(e,t)}handlePlaybackButtons(e){const t=this.getComponentContainer(e);if(!t)return;const i=t.querySelector('[data-video-playback="button"]');if(!i)return;const r=i.querySelector('[data-video-playback="play"]'),o=i.querySelector('[data-video-playback="pause"]');if(!r||!o)return;const s=e=>{e?(r.style.display="none",r.style.visibility="hidden",r.setAttribute("aria-hidden","true"),o.style.display="flex",o.style.visibility="visible",o.setAttribute("aria-hidden","false"),i.setAttribute("aria-label","Pause video")):(r.style.display="flex",r.style.visibility="visible",r.setAttribute("aria-hidden","false"),o.style.display="none",o.style.visibility="hidden",o.setAttribute("aria-hidden","true"),i.setAttribute("aria-label","Play video"))};s(!e.paused);const n=async t=>{if(t.stopPropagation(),e.paused)try{await this.lazyLoadVideo(e),this.hidePictureElement(e),e.play(),s(!0)}catch(e){console.error(e)}else e.pause(),s(!1)},l=()=>s(!0),a=()=>s(!1);i.addEventListener("click",n),e.addEventListener("play",l),e.addEventListener("pause",a),this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push({element:i,type:"click",handler:n},{element:e,type:"play",handler:l},{element:e,type:"pause",handler:a})}async playVideo(e){const t=document.querySelector(`video[data-video="${e}"]`);if(t)try{await this.lazyLoadVideo(t),this.prefersReducedMotion||(this.hidePictureElement(t),t.currentTime=0,t.play())}catch(t){console.error(`Error playing video ${e}:`,t)}else console.warn(`Video with id "${e}" not found`)}pauseVideo(e){const t=document.querySelector(`video[data-video="${e}"]`);t?t.pause():console.warn(`Video with id "${e}" not found`)}pauseAllVideos(){document.querySelectorAll("video[data-video]").forEach((e=>{e.pause()}))}destroy(){this.videoObserver&&this.videoObserver.disconnect(),this.scrollObservers.forEach((e=>{e.disconnect()})),this.scrollObservers.clear(),this.eventListeners.forEach((e=>{e.forEach((({element:e,type:t,handler:i})=>{e.removeEventListener(t,i)}))})),this.eventListeners=new WeakMap,this.resizeHandler&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null),this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),this.pictureElementCache=new WeakMap}reinitialize(){this.destroy(),this.init()}}function initializeVideoLibrary(){document.querySelectorAll("video[data-video]").length>0?window.videoLibrary=new VideoLibrary:window.VideoLibraryConfig?.debug&&console.log("VideoLibrary: No videos detected, skipping auto-initialization.")}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initializeVideoLibrary):initializeVideoLibrary(),"undefined"!=typeof module&&module.exports&&(module.exports=VideoLibrary);
//# sourceMappingURL=/sm/34c618798d13742184781dd5bac8bb21f3db7cdaba0c7260fce4a83de70695e7.map